{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "resourceTypes": [
            "microsoft.logic/workflows",
            "microsoft.web/connections",
            "microsoft.resources/resourcegroups"
        ],
        "basics": [
            {
                "name": "logicAppName",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic App Name",
                "defaultValue": "AADPasswordExpiryNotifier",
                "toolTip": "Azure Logic App that identifies when Azure AD User Accounts' passwords are set to expire. In some cases, users may have multiple user accounts in different Azure AD tenants. These accounts may be different than what they use to login to their machines locally for example, and as such won't be notified about pending password expiry. Without using SSPR (which requires certain licensing, and involves extra costs) this solution notifies the user about their pending password reset via email (through SendGrid, O365, or whatever).",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            },
            {
                "name": "MicrosoftGraphClientId",
                "type": "Microsoft.Common.TextBox",
                "label": "Microsoft Graph Client Id",
                "defaultValue": "",
                "toolTip": "Enter the client Id for the application with read access to Microsoft Graph API.",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            },
            {
                "name": "MicrosoftGraphSecret",
                "type": "Microsoft.Common.TextBox",
                "label": "Microsoft Graph Secret",
                "defaultValue": "",
                "toolTip": "Enter the secret for the application with read access to Microsoft Graph API.",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            },
            {
                "name": "MicrosoftGraphTenant",
                "type": "Microsoft.Common.TextBox",
                "label": "Microsoft Graph Tenant",
                "defaultValue": "",
                "toolTip": "Enter the tenant Id to query users from.",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            },
            {
                "name": "SendgridAccountName",
                "type": "Microsoft.Common.TextBox",
                "label": "Sendgrid Account Name",
                "defaultValue": "sendgrid",
                "toolTip": "Enter the name of the SendGrid account to use to send emails.",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            },
            {
                "name": "SendgridApiKey",
                "type": "Microsoft.Common.PasswordBox",
                "label": {
                    "password": "Sendgrid Api Key",
                    "confirmPassword": "Confirm password"
                },
                "toolTip": "Enter the SendGrid API key for the above account.",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "options": {
                    "hideConfirmation": true
                },
                "visible": true
            },
            {
                "name": "RecurrenceFrequency",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Frequency",
                "defaultValue": "Day",
                "toolTip": "",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            },
            {
                "name": "RecurrenceInterval",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Interval",
                "defaultValue": "1",
                "toolTip": "",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            },
            {
                "name": "RecurrenceSchedule",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Schedule",
                "defaultValue": "{\"hours\":[\"8\"],\"minutes\":[0]}",
                "toolTip": "",
                "constraints": {
                    "required": false,
                    "regex": "",
                    "validationMessage": ""
                },
                "visible": true
            }
        ],
        "steps": [],
        "outputs": {
            "logicAppName": "[basics('logicAppName')]",
            "MicrosoftGraphClientId": "[basics('MicrosoftGraphClientId')]",
            "MicrosoftGraphSecret": "[basics('MicrosoftGraphSecret')]",
            "MicrosoftGraphTenant": "[basics('MicrosoftGraphTenant')]",
            "SendgridAccountName": "[basics('SendgridAccountName')]",
            "SendgridApiKey": "[basics('SendgridApiKey')]",
            "RecurrenceFrequency": "[basics('RecurrenceFrequency')]",
            "RecurrenceInterval": "[basics('RecurrenceInterval')]",
            "RecurrenceSchedule": "[basics('RecurrenceSchedule')]"
        }
    }
}
